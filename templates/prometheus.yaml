apiVersion: monitoring.coreos.com/v1
kind: Prometheus
metadata:
  name: {{ .ApplicationMonitoringName }}
  namespace: {{ .Namespace }}
  labels:
    prometheus: {{ .ApplicationMonitoringName }}
spec:
  externalUrl: https://{{ index .ExtraParams "prometheusHost" }}
  alerting:
    alertmanagers:
      - name: {{ .AlertManagerServiceName }}
        namespace: {{ .Namespace }}
        port: web
  resources:
    requests:
      memory: 400Mi
  serviceAccountName: prometheus-application-monitoring
  serviceMonitorNamespaceSelector:
    matchLabels:
      monitoring-key: {{ .MonitoringKey }}
  serviceMonitorSelector:
    matchLabels:
      monitoring-key: {{ .MonitoringKey }}
  ruleSelector:
    matchLabels:
      monitoring-key: {{ .MonitoringKey }}
  ruleNamespaceSelector:
    matchLabels:
      monitoring-key: {{ .MonitoringKey }}
